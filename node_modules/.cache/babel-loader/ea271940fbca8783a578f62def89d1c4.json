{"ast":null,"code":"var _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) {\n  return typeof obj;\n} : function (obj) {\n  return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n};\n\nfunction _defaults(obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass);\n}\n\nimport baseLogger from './logger.js';\nimport EventEmitter from './EventEmitter.js';\nimport postProcessor from './postProcessor.js';\nimport * as utils from './utils.js';\n\nvar Translator = function (_EventEmitter) {\n  _inherits(Translator, _EventEmitter);\n\n  function Translator(services) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Translator);\n\n    var _this = _possibleConstructorReturn(this, _EventEmitter.call(this));\n\n    utils.copy(['resourceStore', 'languageUtils', 'pluralResolver', 'interpolator', 'backendConnector', 'i18nFormat'], services, _this);\n    _this.options = options;\n\n    if (_this.options.keySeparator === undefined) {\n      _this.options.keySeparator = '.';\n    }\n\n    _this.logger = baseLogger.create('translator');\n    return _this;\n  }\n\n  Translator.prototype.changeLanguage = function changeLanguage(lng) {\n    if (lng) this.language = lng;\n  };\n\n  Translator.prototype.exists = function exists(key) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      interpolation: {}\n    };\n    var resolved = this.resolve(key, options);\n    return resolved && resolved.res !== undefined;\n  };\n\n  Translator.prototype.extractFromKey = function extractFromKey(key, options) {\n    var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n    if (nsSeparator === undefined) nsSeparator = ':';\n    var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n    var namespaces = options.ns || this.options.defaultNS;\n\n    if (nsSeparator && key.indexOf(nsSeparator) > -1) {\n      var parts = key.split(nsSeparator);\n      if (nsSeparator !== keySeparator || nsSeparator === keySeparator && this.options.ns.indexOf(parts[0]) > -1) namespaces = parts.shift();\n      key = parts.join(keySeparator);\n    }\n\n    if (typeof namespaces === 'string') namespaces = [namespaces];\n    return {\n      key: key,\n      namespaces: namespaces\n    };\n  };\n\n  Translator.prototype.translate = function translate(keys, options) {\n    var _this2 = this;\n\n    if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object' && this.options.overloadTranslationOptionHandler) {\n      /* eslint prefer-rest-params: 0 */\n      options = this.options.overloadTranslationOptionHandler(arguments);\n    }\n\n    if (!options) options = {}; // non valid keys handling\n\n    if (keys === undefined || keys === null || keys === '') return '';\n    if (typeof keys === 'number') keys = String(keys);\n    if (typeof keys === 'string') keys = [keys]; // separators\n\n    var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator; // get namespace(s)\n\n    var _extractFromKey = this.extractFromKey(keys[keys.length - 1], options),\n        key = _extractFromKey.key,\n        namespaces = _extractFromKey.namespaces;\n\n    var namespace = namespaces[namespaces.length - 1]; // return key on CIMode\n\n    var lng = options.lng || this.language;\n    var appendNamespaceToCIMode = options.appendNamespaceToCIMode || this.options.appendNamespaceToCIMode;\n\n    if (lng && lng.toLowerCase() === 'cimode') {\n      if (appendNamespaceToCIMode) {\n        var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n        return namespace + nsSeparator + key;\n      }\n\n      return key;\n    } // resolve from store\n\n\n    var resolved = this.resolve(keys, options);\n    var res = resolved && resolved.res;\n    var resUsedKey = resolved && resolved.usedKey || key;\n    var resType = Object.prototype.toString.apply(res);\n    var noObject = ['[object Number]', '[object Function]', '[object RegExp]'];\n    var joinArrays = options.joinArrays !== undefined ? options.joinArrays : this.options.joinArrays; // object\n\n    var handleAsObjectInI18nFormat = !this.i18nFormat || this.i18nFormat.handleAsObject;\n    var handleAsObject = typeof res !== 'string' && typeof res !== 'boolean' && typeof res !== 'number';\n\n    if (handleAsObjectInI18nFormat && res && handleAsObject && noObject.indexOf(resType) < 0 && !(joinArrays && resType === '[object Array]')) {\n      if (!options.returnObjects && !this.options.returnObjects) {\n        this.logger.warn('accessing an object - but returnObjects options is not enabled!');\n        return this.options.returnedObjectHandler ? this.options.returnedObjectHandler(resUsedKey, res, options) : 'key \\'' + key + ' (' + this.language + ')\\' returned an object instead of string.';\n      } // if we got a separator we loop over children - else we just return object as is\n      // as having it set to false means no hierarchy so no lookup for nested values\n\n\n      if (keySeparator) {\n        var copy = resType === '[object Array]' ? [] : {}; // apply child translation on a copy\n\n        /* eslint no-restricted-syntax: 0 */\n\n        for (var m in res) {\n          if (Object.prototype.hasOwnProperty.call(res, m)) {\n            var deepKey = '' + resUsedKey + keySeparator + m;\n            copy[m] = this.translate(deepKey, _extends({}, options, {\n              joinArrays: false,\n              ns: namespaces\n            }));\n            if (copy[m] === deepKey) copy[m] = res[m]; // if nothing found use orginal value as fallback\n          }\n        }\n\n        res = copy;\n      }\n    } else if (handleAsObjectInI18nFormat && joinArrays && resType === '[object Array]') {\n      // array special treatment\n      res = res.join(joinArrays);\n      if (res) res = this.extendTranslation(res, keys, options);\n    } else {\n      // string, empty or null\n      var usedDefault = false;\n      var usedKey = false; // fallback value\n\n      if (!this.isValidLookup(res) && options.defaultValue !== undefined) {\n        usedDefault = true;\n\n        if (options.count !== undefined) {\n          var suffix = this.pluralResolver.getSuffix(lng, options.count);\n          res = options['defaultValue' + suffix];\n        }\n\n        if (!res) res = options.defaultValue;\n      }\n\n      if (!this.isValidLookup(res)) {\n        usedKey = true;\n        res = key;\n      } // save missing\n\n\n      var updateMissing = options.defaultValue && options.defaultValue !== res && this.options.updateMissing;\n\n      if (usedKey || usedDefault || updateMissing) {\n        this.logger.log(updateMissing ? 'updateKey' : 'missingKey', lng, namespace, key, updateMissing ? options.defaultValue : res);\n        var lngs = [];\n        var fallbackLngs = this.languageUtils.getFallbackCodes(this.options.fallbackLng, options.lng || this.language);\n\n        if (this.options.saveMissingTo === 'fallback' && fallbackLngs && fallbackLngs[0]) {\n          for (var i = 0; i < fallbackLngs.length; i++) {\n            lngs.push(fallbackLngs[i]);\n          }\n        } else if (this.options.saveMissingTo === 'all') {\n          lngs = this.languageUtils.toResolveHierarchy(options.lng || this.language);\n        } else {\n          lngs.push(options.lng || this.language);\n        }\n\n        var send = function send(l, k) {\n          if (_this2.options.missingKeyHandler) {\n            _this2.options.missingKeyHandler(l, namespace, k, updateMissing ? options.defaultValue : res, updateMissing, options);\n          } else if (_this2.backendConnector && _this2.backendConnector.saveMissing) {\n            _this2.backendConnector.saveMissing(l, namespace, k, updateMissing ? options.defaultValue : res, updateMissing, options);\n          }\n\n          _this2.emit('missingKey', l, namespace, k, res);\n        };\n\n        if (this.options.saveMissing) {\n          var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n\n          if (this.options.saveMissingPlurals && needsPluralHandling) {\n            lngs.forEach(function (l) {\n              var plurals = _this2.pluralResolver.getPluralFormsOfKey(l, key);\n\n              plurals.forEach(function (p) {\n                return send([l], p);\n              });\n            });\n          } else {\n            send(lngs, key);\n          }\n        }\n      } // extend\n\n\n      res = this.extendTranslation(res, keys, options, resolved); // append namespace if still key\n\n      if (usedKey && res === key && this.options.appendNamespaceToMissingKey) res = namespace + ':' + key; // parseMissingKeyHandler\n\n      if (usedKey && this.options.parseMissingKeyHandler) res = this.options.parseMissingKeyHandler(res);\n    } // return\n\n\n    return res;\n  };\n\n  Translator.prototype.extendTranslation = function extendTranslation(res, key, options, resolved) {\n    var _this3 = this;\n\n    if (this.i18nFormat && this.i18nFormat.parse) {\n      res = this.i18nFormat.parse(res, options, resolved.usedLng, resolved.usedNS, resolved.usedKey, {\n        resolved: resolved\n      });\n    } else if (!options.skipInterpolation) {\n      // i18next.parsing\n      if (options.interpolation) this.interpolator.init(_extends({}, options, {\n        interpolation: _extends({}, this.options.interpolation, options.interpolation)\n      })); // interpolate\n\n      var data = options.replace && typeof options.replace !== 'string' ? options.replace : options;\n      if (this.options.interpolation.defaultVariables) data = _extends({}, this.options.interpolation.defaultVariables, data);\n      res = this.interpolator.interpolate(res, data, options.lng || this.language, options); // nesting\n\n      if (options.nest !== false) res = this.interpolator.nest(res, function () {\n        return _this3.translate.apply(_this3, arguments);\n      }, options);\n      if (options.interpolation) this.interpolator.reset();\n    } // post process\n\n\n    var postProcess = options.postProcess || this.options.postProcess;\n    var postProcessorNames = typeof postProcess === 'string' ? [postProcess] : postProcess;\n\n    if (res !== undefined && res !== null && postProcessorNames && postProcessorNames.length && options.applyPostProcessor !== false) {\n      res = postProcessor.handle(postProcessorNames, res, key, options, this);\n    }\n\n    return res;\n  };\n\n  Translator.prototype.resolve = function resolve(keys) {\n    var _this4 = this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var found = void 0;\n    var usedKey = void 0;\n    var usedLng = void 0;\n    var usedNS = void 0;\n    if (typeof keys === 'string') keys = [keys]; // forEach possible key\n\n    keys.forEach(function (k) {\n      if (_this4.isValidLookup(found)) return;\n\n      var extracted = _this4.extractFromKey(k, options);\n\n      var key = extracted.key;\n      usedKey = key;\n      var namespaces = extracted.namespaces;\n      if (_this4.options.fallbackNS) namespaces = namespaces.concat(_this4.options.fallbackNS);\n      var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n      var needsContextHandling = options.context !== undefined && typeof options.context === 'string' && options.context !== '';\n      var codes = options.lngs ? options.lngs : _this4.languageUtils.toResolveHierarchy(options.lng || _this4.language, options.fallbackLng);\n      namespaces.forEach(function (ns) {\n        if (_this4.isValidLookup(found)) return;\n        usedNS = ns;\n        codes.forEach(function (code) {\n          if (_this4.isValidLookup(found)) return;\n          usedLng = code;\n          var finalKey = key;\n          var finalKeys = [finalKey];\n\n          if (_this4.i18nFormat && _this4.i18nFormat.addLookupKeys) {\n            _this4.i18nFormat.addLookupKeys(finalKeys, key, code, ns, options);\n          } else {\n            var pluralSuffix = void 0;\n            if (needsPluralHandling) pluralSuffix = _this4.pluralResolver.getSuffix(code, options.count); // fallback for plural if context not found\n\n            if (needsPluralHandling && needsContextHandling) finalKeys.push(finalKey + pluralSuffix); // get key for context if needed\n\n            if (needsContextHandling) finalKeys.push(finalKey += '' + _this4.options.contextSeparator + options.context); // get key for plural if needed\n\n            if (needsPluralHandling) finalKeys.push(finalKey += pluralSuffix);\n          } // iterate over finalKeys starting with most specific pluralkey (-> contextkey only) -> singularkey only\n\n\n          var possibleKey = void 0;\n          /* eslint no-cond-assign: 0 */\n\n          while (possibleKey = finalKeys.pop()) {\n            if (!_this4.isValidLookup(found)) {\n              found = _this4.getResource(code, ns, possibleKey, options);\n            }\n          }\n        });\n      });\n    });\n    return {\n      res: found,\n      usedKey: usedKey,\n      usedLng: usedLng,\n      usedNS: usedNS\n    };\n  };\n\n  Translator.prototype.isValidLookup = function isValidLookup(res) {\n    return res !== undefined && !(!this.options.returnNull && res === null) && !(!this.options.returnEmptyString && res === '');\n  };\n\n  Translator.prototype.getResource = function getResource(code, ns, key) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    if (this.i18nFormat && this.i18nFormat.getResource) return this.i18nFormat.getResource(code, ns, key, options);\n    return this.resourceStore.getResource(code, ns, key, options);\n  };\n\n  return Translator;\n}(EventEmitter);\n\nexport default Translator;","map":{"version":3,"sources":["/Users/a18322/Desktop/reactjs-seed/node_modules/i18next/dist/es/Translator.js"],"names":["_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_typeof","Symbol","iterator","obj","constructor","_defaults","defaults","keys","getOwnPropertyNames","value","getOwnPropertyDescriptor","configurable","undefined","defineProperty","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","enumerable","writable","setPrototypeOf","baseLogger","EventEmitter","postProcessor","utils","Translator","_EventEmitter","services","options","_this","copy","keySeparator","logger","changeLanguage","lng","language","exists","interpolation","resolved","resolve","res","extractFromKey","nsSeparator","namespaces","ns","defaultNS","indexOf","parts","split","shift","join","translate","_this2","overloadTranslationOptionHandler","String","_extractFromKey","namespace","appendNamespaceToCIMode","toLowerCase","resUsedKey","usedKey","resType","toString","apply","noObject","joinArrays","handleAsObjectInI18nFormat","i18nFormat","handleAsObject","returnObjects","warn","returnedObjectHandler","m","deepKey","extendTranslation","usedDefault","isValidLookup","defaultValue","count","suffix","pluralResolver","getSuffix","updateMissing","log","lngs","fallbackLngs","languageUtils","getFallbackCodes","fallbackLng","saveMissingTo","push","toResolveHierarchy","send","l","k","missingKeyHandler","backendConnector","saveMissing","emit","needsPluralHandling","saveMissingPlurals","forEach","plurals","getPluralFormsOfKey","p","appendNamespaceToMissingKey","parseMissingKeyHandler","_this3","parse","usedLng","usedNS","skipInterpolation","interpolator","init","data","replace","defaultVariables","interpolate","nest","reset","postProcess","postProcessorNames","applyPostProcessor","handle","_this4","found","extracted","fallbackNS","concat","needsContextHandling","context","codes","code","finalKey","finalKeys","addLookupKeys","pluralSuffix","contextSeparator","possibleKey","pop","getResource","returnNull","returnEmptyString","resourceStore"],"mappings":"AAAA,IAAIA,QAAQ,GAAGC,MAAM,CAACC,MAAP,IAAiB,UAAUC,MAAV,EAAkB;AAAE,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGC,SAAS,CAACC,MAA9B,EAAsCF,CAAC,EAAvC,EAA2C;AAAE,QAAIG,MAAM,GAAGF,SAAS,CAACD,CAAD,CAAtB;;AAA2B,SAAK,IAAII,GAAT,IAAgBD,MAAhB,EAAwB;AAAE,UAAIN,MAAM,CAACQ,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCJ,MAArC,EAA6CC,GAA7C,CAAJ,EAAuD;AAAEL,QAAAA,MAAM,CAACK,GAAD,CAAN,GAAcD,MAAM,CAACC,GAAD,CAApB;AAA4B;AAAE;AAAE;;AAAC,SAAOL,MAAP;AAAgB,CAAhQ;;AAEA,IAAIS,OAAO,GAAG,OAAOC,MAAP,KAAkB,UAAlB,IAAgC,OAAOA,MAAM,CAACC,QAAd,KAA2B,QAA3D,GAAsE,UAAUC,GAAV,EAAe;AAAE,SAAO,OAAOA,GAAd;AAAoB,CAA3G,GAA8G,UAAUA,GAAV,EAAe;AAAE,SAAOA,GAAG,IAAI,OAAOF,MAAP,KAAkB,UAAzB,IAAuCE,GAAG,CAACC,WAAJ,KAAoBH,MAA3D,IAAqEE,GAAG,KAAKF,MAAM,CAACJ,SAApF,GAAgG,QAAhG,GAA2G,OAAOM,GAAzH;AAA+H,CAA5Q;;AAEA,SAASE,SAAT,CAAmBF,GAAnB,EAAwBG,QAAxB,EAAkC;AAAE,MAAIC,IAAI,GAAGlB,MAAM,CAACmB,mBAAP,CAA2BF,QAA3B,CAAX;;AAAiD,OAAK,IAAId,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGe,IAAI,CAACb,MAAzB,EAAiCF,CAAC,EAAlC,EAAsC;AAAE,QAAII,GAAG,GAAGW,IAAI,CAACf,CAAD,CAAd;AAAmB,QAAIiB,KAAK,GAAGpB,MAAM,CAACqB,wBAAP,CAAgCJ,QAAhC,EAA0CV,GAA1C,CAAZ;;AAA4D,QAAIa,KAAK,IAAIA,KAAK,CAACE,YAAf,IAA+BR,GAAG,CAACP,GAAD,CAAH,KAAagB,SAAhD,EAA2D;AAAEvB,MAAAA,MAAM,CAACwB,cAAP,CAAsBV,GAAtB,EAA2BP,GAA3B,EAAgCa,KAAhC;AAAyC;AAAE;;AAAC,SAAON,GAAP;AAAa;;AAElU,SAASW,eAAT,CAAyBC,QAAzB,EAAmCC,WAAnC,EAAgD;AAAE,MAAI,EAAED,QAAQ,YAAYC,WAAtB,CAAJ,EAAwC;AAAE,UAAM,IAAIC,SAAJ,CAAc,mCAAd,CAAN;AAA2D;AAAE;;AAEzJ,SAASC,0BAAT,CAAoCC,IAApC,EAA0CpB,IAA1C,EAAgD;AAAE,MAAI,CAACoB,IAAL,EAAW;AAAE,UAAM,IAAIC,cAAJ,CAAmB,2DAAnB,CAAN;AAAwF;;AAAC,SAAOrB,IAAI,KAAK,OAAOA,IAAP,KAAgB,QAAhB,IAA4B,OAAOA,IAAP,KAAgB,UAAjD,CAAJ,GAAmEA,IAAnE,GAA0EoB,IAAjF;AAAwF;;AAEhP,SAASE,SAAT,CAAmBC,QAAnB,EAA6BC,UAA7B,EAAyC;AAAE,MAAI,OAAOA,UAAP,KAAsB,UAAtB,IAAoCA,UAAU,KAAK,IAAvD,EAA6D;AAAE,UAAM,IAAIN,SAAJ,CAAc,6DAA6D,OAAOM,UAAlF,CAAN;AAAsG;;AAACD,EAAAA,QAAQ,CAACzB,SAAT,GAAqBR,MAAM,CAACmC,MAAP,CAAcD,UAAU,IAAIA,UAAU,CAAC1B,SAAvC,EAAkD;AAAEO,IAAAA,WAAW,EAAE;AAAEK,MAAAA,KAAK,EAAEa,QAAT;AAAmBG,MAAAA,UAAU,EAAE,KAA/B;AAAsCC,MAAAA,QAAQ,EAAE,IAAhD;AAAsDf,MAAAA,YAAY,EAAE;AAApE;AAAf,GAAlD,CAArB;AAAqK,MAAIY,UAAJ,EAAgBlC,MAAM,CAACsC,cAAP,GAAwBtC,MAAM,CAACsC,cAAP,CAAsBL,QAAtB,EAAgCC,UAAhC,CAAxB,GAAsElB,SAAS,CAACiB,QAAD,EAAWC,UAAX,CAA/E;AAAwG;;AAE9e,OAAOK,UAAP,MAAuB,aAAvB;AACA,OAAOC,YAAP,MAAyB,mBAAzB;AACA,OAAOC,aAAP,MAA0B,oBAA1B;AACA,OAAO,KAAKC,KAAZ,MAAuB,YAAvB;;AAEA,IAAIC,UAAU,GAAG,UAAUC,aAAV,EAAyB;AACxCZ,EAAAA,SAAS,CAACW,UAAD,EAAaC,aAAb,CAAT;;AAEA,WAASD,UAAT,CAAoBE,QAApB,EAA8B;AAC5B,QAAIC,OAAO,GAAG1C,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBmB,SAAzC,GAAqDnB,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAAlF;;AAEAqB,IAAAA,eAAe,CAAC,IAAD,EAAOkB,UAAP,CAAf;;AAEA,QAAII,KAAK,GAAGlB,0BAA0B,CAAC,IAAD,EAAOe,aAAa,CAAClC,IAAd,CAAmB,IAAnB,CAAP,CAAtC;;AAEAgC,IAAAA,KAAK,CAACM,IAAN,CAAW,CAAC,eAAD,EAAkB,eAAlB,EAAmC,gBAAnC,EAAqD,cAArD,EAAqE,kBAArE,EAAyF,YAAzF,CAAX,EAAmHH,QAAnH,EAA6HE,KAA7H;AAEAA,IAAAA,KAAK,CAACD,OAAN,GAAgBA,OAAhB;;AACA,QAAIC,KAAK,CAACD,OAAN,CAAcG,YAAd,KAA+B1B,SAAnC,EAA8C;AAC5CwB,MAAAA,KAAK,CAACD,OAAN,CAAcG,YAAd,GAA6B,GAA7B;AACD;;AAEDF,IAAAA,KAAK,CAACG,MAAN,GAAeX,UAAU,CAACJ,MAAX,CAAkB,YAAlB,CAAf;AACA,WAAOY,KAAP;AACD;;AAEDJ,EAAAA,UAAU,CAACnC,SAAX,CAAqB2C,cAArB,GAAsC,SAASA,cAAT,CAAwBC,GAAxB,EAA6B;AACjE,QAAIA,GAAJ,EAAS,KAAKC,QAAL,GAAgBD,GAAhB;AACV,GAFD;;AAIAT,EAAAA,UAAU,CAACnC,SAAX,CAAqB8C,MAArB,GAA8B,SAASA,MAAT,CAAgB/C,GAAhB,EAAqB;AACjD,QAAIuC,OAAO,GAAG1C,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBmB,SAAzC,GAAqDnB,SAAS,CAAC,CAAD,CAA9D,GAAoE;AAAEmD,MAAAA,aAAa,EAAE;AAAjB,KAAlF;AAEA,QAAIC,QAAQ,GAAG,KAAKC,OAAL,CAAalD,GAAb,EAAkBuC,OAAlB,CAAf;AACA,WAAOU,QAAQ,IAAIA,QAAQ,CAACE,GAAT,KAAiBnC,SAApC;AACD,GALD;;AAOAoB,EAAAA,UAAU,CAACnC,SAAX,CAAqBmD,cAArB,GAAsC,SAASA,cAAT,CAAwBpD,GAAxB,EAA6BuC,OAA7B,EAAsC;AAC1E,QAAIc,WAAW,GAAGd,OAAO,CAACc,WAAR,IAAuB,KAAKd,OAAL,CAAac,WAAtD;AACA,QAAIA,WAAW,KAAKrC,SAApB,EAA+BqC,WAAW,GAAG,GAAd;AAE/B,QAAIX,YAAY,GAAGH,OAAO,CAACG,YAAR,KAAyB1B,SAAzB,GAAqCuB,OAAO,CAACG,YAA7C,GAA4D,KAAKH,OAAL,CAAaG,YAA5F;AAEA,QAAIY,UAAU,GAAGf,OAAO,CAACgB,EAAR,IAAc,KAAKhB,OAAL,CAAaiB,SAA5C;;AACA,QAAIH,WAAW,IAAIrD,GAAG,CAACyD,OAAJ,CAAYJ,WAAZ,IAA2B,CAAC,CAA/C,EAAkD;AAChD,UAAIK,KAAK,GAAG1D,GAAG,CAAC2D,KAAJ,CAAUN,WAAV,CAAZ;AACA,UAAIA,WAAW,KAAKX,YAAhB,IAAgCW,WAAW,KAAKX,YAAhB,IAAgC,KAAKH,OAAL,CAAagB,EAAb,CAAgBE,OAAhB,CAAwBC,KAAK,CAAC,CAAD,CAA7B,IAAoC,CAAC,CAAzG,EAA4GJ,UAAU,GAAGI,KAAK,CAACE,KAAN,EAAb;AAC5G5D,MAAAA,GAAG,GAAG0D,KAAK,CAACG,IAAN,CAAWnB,YAAX,CAAN;AACD;;AACD,QAAI,OAAOY,UAAP,KAAsB,QAA1B,EAAoCA,UAAU,GAAG,CAACA,UAAD,CAAb;AAEpC,WAAO;AACLtD,MAAAA,GAAG,EAAEA,GADA;AAELsD,MAAAA,UAAU,EAAEA;AAFP,KAAP;AAID,GAlBD;;AAoBAlB,EAAAA,UAAU,CAACnC,SAAX,CAAqB6D,SAArB,GAAiC,SAASA,SAAT,CAAmBnD,IAAnB,EAAyB4B,OAAzB,EAAkC;AACjE,QAAIwB,MAAM,GAAG,IAAb;;AAEA,QAAI,CAAC,OAAOxB,OAAP,KAAmB,WAAnB,GAAiC,WAAjC,GAA+CnC,OAAO,CAACmC,OAAD,CAAvD,MAAsE,QAAtE,IAAkF,KAAKA,OAAL,CAAayB,gCAAnG,EAAqI;AACnI;AACAzB,MAAAA,OAAO,GAAG,KAAKA,OAAL,CAAayB,gCAAb,CAA8CnE,SAA9C,CAAV;AACD;;AACD,QAAI,CAAC0C,OAAL,EAAcA,OAAO,GAAG,EAAV,CAPmD,CASjE;;AACA,QAAI5B,IAAI,KAAKK,SAAT,IAAsBL,IAAI,KAAK,IAA/B,IAAuCA,IAAI,KAAK,EAApD,EAAwD,OAAO,EAAP;AACxD,QAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8BA,IAAI,GAAGsD,MAAM,CAACtD,IAAD,CAAb;AAC9B,QAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8BA,IAAI,GAAG,CAACA,IAAD,CAAP,CAZmC,CAcjE;;AACA,QAAI+B,YAAY,GAAGH,OAAO,CAACG,YAAR,KAAyB1B,SAAzB,GAAqCuB,OAAO,CAACG,YAA7C,GAA4D,KAAKH,OAAL,CAAaG,YAA5F,CAfiE,CAiBjE;;AAEA,QAAIwB,eAAe,GAAG,KAAKd,cAAL,CAAoBzC,IAAI,CAACA,IAAI,CAACb,MAAL,GAAc,CAAf,CAAxB,EAA2CyC,OAA3C,CAAtB;AAAA,QACIvC,GAAG,GAAGkE,eAAe,CAAClE,GAD1B;AAAA,QAEIsD,UAAU,GAAGY,eAAe,CAACZ,UAFjC;;AAIA,QAAIa,SAAS,GAAGb,UAAU,CAACA,UAAU,CAACxD,MAAX,GAAoB,CAArB,CAA1B,CAvBiE,CAyBjE;;AACA,QAAI+C,GAAG,GAAGN,OAAO,CAACM,GAAR,IAAe,KAAKC,QAA9B;AACA,QAAIsB,uBAAuB,GAAG7B,OAAO,CAAC6B,uBAAR,IAAmC,KAAK7B,OAAL,CAAa6B,uBAA9E;;AACA,QAAIvB,GAAG,IAAIA,GAAG,CAACwB,WAAJ,OAAsB,QAAjC,EAA2C;AACzC,UAAID,uBAAJ,EAA6B;AAC3B,YAAIf,WAAW,GAAGd,OAAO,CAACc,WAAR,IAAuB,KAAKd,OAAL,CAAac,WAAtD;AACA,eAAOc,SAAS,GAAGd,WAAZ,GAA0BrD,GAAjC;AACD;;AAED,aAAOA,GAAP;AACD,KAnCgE,CAqCjE;;;AACA,QAAIiD,QAAQ,GAAG,KAAKC,OAAL,CAAavC,IAAb,EAAmB4B,OAAnB,CAAf;AACA,QAAIY,GAAG,GAAGF,QAAQ,IAAIA,QAAQ,CAACE,GAA/B;AACA,QAAImB,UAAU,GAAGrB,QAAQ,IAAIA,QAAQ,CAACsB,OAArB,IAAgCvE,GAAjD;AAEA,QAAIwE,OAAO,GAAG/E,MAAM,CAACQ,SAAP,CAAiBwE,QAAjB,CAA0BC,KAA1B,CAAgCvB,GAAhC,CAAd;AACA,QAAIwB,QAAQ,GAAG,CAAC,iBAAD,EAAoB,mBAApB,EAAyC,iBAAzC,CAAf;AACA,QAAIC,UAAU,GAAGrC,OAAO,CAACqC,UAAR,KAAuB5D,SAAvB,GAAmCuB,OAAO,CAACqC,UAA3C,GAAwD,KAAKrC,OAAL,CAAaqC,UAAtF,CA5CiE,CA8CjE;;AACA,QAAIC,0BAA0B,GAAG,CAAC,KAAKC,UAAN,IAAoB,KAAKA,UAAL,CAAgBC,cAArE;AACA,QAAIA,cAAc,GAAG,OAAO5B,GAAP,KAAe,QAAf,IAA2B,OAAOA,GAAP,KAAe,SAA1C,IAAuD,OAAOA,GAAP,KAAe,QAA3F;;AACA,QAAI0B,0BAA0B,IAAI1B,GAA9B,IAAqC4B,cAArC,IAAuDJ,QAAQ,CAAClB,OAAT,CAAiBe,OAAjB,IAA4B,CAAnF,IAAwF,EAAEI,UAAU,IAAIJ,OAAO,KAAK,gBAA5B,CAA5F,EAA2I;AACzI,UAAI,CAACjC,OAAO,CAACyC,aAAT,IAA0B,CAAC,KAAKzC,OAAL,CAAayC,aAA5C,EAA2D;AACzD,aAAKrC,MAAL,CAAYsC,IAAZ,CAAiB,iEAAjB;AACA,eAAO,KAAK1C,OAAL,CAAa2C,qBAAb,GAAqC,KAAK3C,OAAL,CAAa2C,qBAAb,CAAmCZ,UAAnC,EAA+CnB,GAA/C,EAAoDZ,OAApD,CAArC,GAAoG,WAAWvC,GAAX,GAAiB,IAAjB,GAAwB,KAAK8C,QAA7B,GAAwC,2CAAnJ;AACD,OAJwI,CAMzI;AACA;;;AACA,UAAIJ,YAAJ,EAAkB;AAChB,YAAID,IAAI,GAAG+B,OAAO,KAAK,gBAAZ,GAA+B,EAA/B,GAAoC,EAA/C,CADgB,CACmC;;AAEnD;;AACA,aAAK,IAAIW,CAAT,IAAchC,GAAd,EAAmB;AACjB,cAAI1D,MAAM,CAACQ,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCgD,GAArC,EAA0CgC,CAA1C,CAAJ,EAAkD;AAChD,gBAAIC,OAAO,GAAG,KAAKd,UAAL,GAAkB5B,YAAlB,GAAiCyC,CAA/C;AACA1C,YAAAA,IAAI,CAAC0C,CAAD,CAAJ,GAAU,KAAKrB,SAAL,CAAesB,OAAf,EAAwB5F,QAAQ,CAAC,EAAD,EAAK+C,OAAL,EAAc;AAAEqC,cAAAA,UAAU,EAAE,KAAd;AAAqBrB,cAAAA,EAAE,EAAED;AAAzB,aAAd,CAAhC,CAAV;AACA,gBAAIb,IAAI,CAAC0C,CAAD,CAAJ,KAAYC,OAAhB,EAAyB3C,IAAI,CAAC0C,CAAD,CAAJ,GAAUhC,GAAG,CAACgC,CAAD,CAAb,CAHuB,CAGL;AAC5C;AACF;;AACDhC,QAAAA,GAAG,GAAGV,IAAN;AACD;AACF,KArBD,MAqBO,IAAIoC,0BAA0B,IAAID,UAA9B,IAA4CJ,OAAO,KAAK,gBAA5D,EAA8E;AACnF;AACArB,MAAAA,GAAG,GAAGA,GAAG,CAACU,IAAJ,CAASe,UAAT,CAAN;AACA,UAAIzB,GAAJ,EAASA,GAAG,GAAG,KAAKkC,iBAAL,CAAuBlC,GAAvB,EAA4BxC,IAA5B,EAAkC4B,OAAlC,CAAN;AACV,KAJM,MAIA;AACL;AACA,UAAI+C,WAAW,GAAG,KAAlB;AACA,UAAIf,OAAO,GAAG,KAAd,CAHK,CAKL;;AACA,UAAI,CAAC,KAAKgB,aAAL,CAAmBpC,GAAnB,CAAD,IAA4BZ,OAAO,CAACiD,YAAR,KAAyBxE,SAAzD,EAAoE;AAClEsE,QAAAA,WAAW,GAAG,IAAd;;AAEA,YAAI/C,OAAO,CAACkD,KAAR,KAAkBzE,SAAtB,EAAiC;AAC/B,cAAI0E,MAAM,GAAG,KAAKC,cAAL,CAAoBC,SAApB,CAA8B/C,GAA9B,EAAmCN,OAAO,CAACkD,KAA3C,CAAb;AACAtC,UAAAA,GAAG,GAAGZ,OAAO,CAAC,iBAAiBmD,MAAlB,CAAb;AACD;;AACD,YAAI,CAACvC,GAAL,EAAUA,GAAG,GAAGZ,OAAO,CAACiD,YAAd;AACX;;AACD,UAAI,CAAC,KAAKD,aAAL,CAAmBpC,GAAnB,CAAL,EAA8B;AAC5BoB,QAAAA,OAAO,GAAG,IAAV;AACApB,QAAAA,GAAG,GAAGnD,GAAN;AACD,OAlBI,CAoBL;;;AACA,UAAI6F,aAAa,GAAGtD,OAAO,CAACiD,YAAR,IAAwBjD,OAAO,CAACiD,YAAR,KAAyBrC,GAAjD,IAAwD,KAAKZ,OAAL,CAAasD,aAAzF;;AACA,UAAItB,OAAO,IAAIe,WAAX,IAA0BO,aAA9B,EAA6C;AAC3C,aAAKlD,MAAL,CAAYmD,GAAZ,CAAgBD,aAAa,GAAG,WAAH,GAAiB,YAA9C,EAA4DhD,GAA5D,EAAiEsB,SAAjE,EAA4EnE,GAA5E,EAAiF6F,aAAa,GAAGtD,OAAO,CAACiD,YAAX,GAA0BrC,GAAxH;AAEA,YAAI4C,IAAI,GAAG,EAAX;AACA,YAAIC,YAAY,GAAG,KAAKC,aAAL,CAAmBC,gBAAnB,CAAoC,KAAK3D,OAAL,CAAa4D,WAAjD,EAA8D5D,OAAO,CAACM,GAAR,IAAe,KAAKC,QAAlF,CAAnB;;AACA,YAAI,KAAKP,OAAL,CAAa6D,aAAb,KAA+B,UAA/B,IAA6CJ,YAA7C,IAA6DA,YAAY,CAAC,CAAD,CAA7E,EAAkF;AAChF,eAAK,IAAIpG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGoG,YAAY,CAAClG,MAAjC,EAAyCF,CAAC,EAA1C,EAA8C;AAC5CmG,YAAAA,IAAI,CAACM,IAAL,CAAUL,YAAY,CAACpG,CAAD,CAAtB;AACD;AACF,SAJD,MAIO,IAAI,KAAK2C,OAAL,CAAa6D,aAAb,KAA+B,KAAnC,EAA0C;AAC/CL,UAAAA,IAAI,GAAG,KAAKE,aAAL,CAAmBK,kBAAnB,CAAsC/D,OAAO,CAACM,GAAR,IAAe,KAAKC,QAA1D,CAAP;AACD,SAFM,MAEA;AACLiD,UAAAA,IAAI,CAACM,IAAL,CAAU9D,OAAO,CAACM,GAAR,IAAe,KAAKC,QAA9B;AACD;;AAED,YAAIyD,IAAI,GAAG,SAASA,IAAT,CAAcC,CAAd,EAAiBC,CAAjB,EAAoB;AAC7B,cAAI1C,MAAM,CAACxB,OAAP,CAAemE,iBAAnB,EAAsC;AACpC3C,YAAAA,MAAM,CAACxB,OAAP,CAAemE,iBAAf,CAAiCF,CAAjC,EAAoCrC,SAApC,EAA+CsC,CAA/C,EAAkDZ,aAAa,GAAGtD,OAAO,CAACiD,YAAX,GAA0BrC,GAAzF,EAA8F0C,aAA9F,EAA6GtD,OAA7G;AACD,WAFD,MAEO,IAAIwB,MAAM,CAAC4C,gBAAP,IAA2B5C,MAAM,CAAC4C,gBAAP,CAAwBC,WAAvD,EAAoE;AACzE7C,YAAAA,MAAM,CAAC4C,gBAAP,CAAwBC,WAAxB,CAAoCJ,CAApC,EAAuCrC,SAAvC,EAAkDsC,CAAlD,EAAqDZ,aAAa,GAAGtD,OAAO,CAACiD,YAAX,GAA0BrC,GAA5F,EAAiG0C,aAAjG,EAAgHtD,OAAhH;AACD;;AACDwB,UAAAA,MAAM,CAAC8C,IAAP,CAAY,YAAZ,EAA0BL,CAA1B,EAA6BrC,SAA7B,EAAwCsC,CAAxC,EAA2CtD,GAA3C;AACD,SAPD;;AASA,YAAI,KAAKZ,OAAL,CAAaqE,WAAjB,EAA8B;AAC5B,cAAIE,mBAAmB,GAAGvE,OAAO,CAACkD,KAAR,KAAkBzE,SAAlB,IAA+B,OAAOuB,OAAO,CAACkD,KAAf,KAAyB,QAAlF;;AACA,cAAI,KAAKlD,OAAL,CAAawE,kBAAb,IAAmCD,mBAAvC,EAA4D;AAC1Df,YAAAA,IAAI,CAACiB,OAAL,CAAa,UAAUR,CAAV,EAAa;AACxB,kBAAIS,OAAO,GAAGlD,MAAM,CAAC4B,cAAP,CAAsBuB,mBAAtB,CAA0CV,CAA1C,EAA6CxG,GAA7C,CAAd;;AAEAiH,cAAAA,OAAO,CAACD,OAAR,CAAgB,UAAUG,CAAV,EAAa;AAC3B,uBAAOZ,IAAI,CAAC,CAACC,CAAD,CAAD,EAAMW,CAAN,CAAX;AACD,eAFD;AAGD,aAND;AAOD,WARD,MAQO;AACLZ,YAAAA,IAAI,CAACR,IAAD,EAAO/F,GAAP,CAAJ;AACD;AACF;AACF,OA5DI,CA8DL;;;AACAmD,MAAAA,GAAG,GAAG,KAAKkC,iBAAL,CAAuBlC,GAAvB,EAA4BxC,IAA5B,EAAkC4B,OAAlC,EAA2CU,QAA3C,CAAN,CA/DK,CAiEL;;AACA,UAAIsB,OAAO,IAAIpB,GAAG,KAAKnD,GAAnB,IAA0B,KAAKuC,OAAL,CAAa6E,2BAA3C,EAAwEjE,GAAG,GAAGgB,SAAS,GAAG,GAAZ,GAAkBnE,GAAxB,CAlEnE,CAoEL;;AACA,UAAIuE,OAAO,IAAI,KAAKhC,OAAL,CAAa8E,sBAA5B,EAAoDlE,GAAG,GAAG,KAAKZ,OAAL,CAAa8E,sBAAb,CAAoClE,GAApC,CAAN;AACrD,KAhJgE,CAkJjE;;;AACA,WAAOA,GAAP;AACD,GApJD;;AAsJAf,EAAAA,UAAU,CAACnC,SAAX,CAAqBoF,iBAArB,GAAyC,SAASA,iBAAT,CAA2BlC,GAA3B,EAAgCnD,GAAhC,EAAqCuC,OAArC,EAA8CU,QAA9C,EAAwD;AAC/F,QAAIqE,MAAM,GAAG,IAAb;;AAEA,QAAI,KAAKxC,UAAL,IAAmB,KAAKA,UAAL,CAAgByC,KAAvC,EAA8C;AAC5CpE,MAAAA,GAAG,GAAG,KAAK2B,UAAL,CAAgByC,KAAhB,CAAsBpE,GAAtB,EAA2BZ,OAA3B,EAAoCU,QAAQ,CAACuE,OAA7C,EAAsDvE,QAAQ,CAACwE,MAA/D,EAAuExE,QAAQ,CAACsB,OAAhF,EAAyF;AAAEtB,QAAAA,QAAQ,EAAEA;AAAZ,OAAzF,CAAN;AACD,KAFD,MAEO,IAAI,CAACV,OAAO,CAACmF,iBAAb,EAAgC;AACrC;AACA,UAAInF,OAAO,CAACS,aAAZ,EAA2B,KAAK2E,YAAL,CAAkBC,IAAlB,CAAuBpI,QAAQ,CAAC,EAAD,EAAK+C,OAAL,EAAc;AAAES,QAAAA,aAAa,EAAExD,QAAQ,CAAC,EAAD,EAAK,KAAK+C,OAAL,CAAaS,aAAlB,EAAiCT,OAAO,CAACS,aAAzC;AAAzB,OAAd,CAA/B,EAFU,CAIrC;;AACA,UAAI6E,IAAI,GAAGtF,OAAO,CAACuF,OAAR,IAAmB,OAAOvF,OAAO,CAACuF,OAAf,KAA2B,QAA9C,GAAyDvF,OAAO,CAACuF,OAAjE,GAA2EvF,OAAtF;AACA,UAAI,KAAKA,OAAL,CAAaS,aAAb,CAA2B+E,gBAA/B,EAAiDF,IAAI,GAAGrI,QAAQ,CAAC,EAAD,EAAK,KAAK+C,OAAL,CAAaS,aAAb,CAA2B+E,gBAAhC,EAAkDF,IAAlD,CAAf;AACjD1E,MAAAA,GAAG,GAAG,KAAKwE,YAAL,CAAkBK,WAAlB,CAA8B7E,GAA9B,EAAmC0E,IAAnC,EAAyCtF,OAAO,CAACM,GAAR,IAAe,KAAKC,QAA7D,EAAuEP,OAAvE,CAAN,CAPqC,CASrC;;AACA,UAAIA,OAAO,CAAC0F,IAAR,KAAiB,KAArB,EAA4B9E,GAAG,GAAG,KAAKwE,YAAL,CAAkBM,IAAlB,CAAuB9E,GAAvB,EAA4B,YAAY;AACxE,eAAOmE,MAAM,CAACxD,SAAP,CAAiBY,KAAjB,CAAuB4C,MAAvB,EAA+BzH,SAA/B,CAAP;AACD,OAFiC,EAE/B0C,OAF+B,CAAN;AAI5B,UAAIA,OAAO,CAACS,aAAZ,EAA2B,KAAK2E,YAAL,CAAkBO,KAAlB;AAC5B,KApB8F,CAsB/F;;;AACA,QAAIC,WAAW,GAAG5F,OAAO,CAAC4F,WAAR,IAAuB,KAAK5F,OAAL,CAAa4F,WAAtD;AACA,QAAIC,kBAAkB,GAAG,OAAOD,WAAP,KAAuB,QAAvB,GAAkC,CAACA,WAAD,CAAlC,GAAkDA,WAA3E;;AAEA,QAAIhF,GAAG,KAAKnC,SAAR,IAAqBmC,GAAG,KAAK,IAA7B,IAAqCiF,kBAArC,IAA2DA,kBAAkB,CAACtI,MAA9E,IAAwFyC,OAAO,CAAC8F,kBAAR,KAA+B,KAA3H,EAAkI;AAChIlF,MAAAA,GAAG,GAAGjB,aAAa,CAACoG,MAAd,CAAqBF,kBAArB,EAAyCjF,GAAzC,EAA8CnD,GAA9C,EAAmDuC,OAAnD,EAA4D,IAA5D,CAAN;AACD;;AAED,WAAOY,GAAP;AACD,GA/BD;;AAiCAf,EAAAA,UAAU,CAACnC,SAAX,CAAqBiD,OAArB,GAA+B,SAASA,OAAT,CAAiBvC,IAAjB,EAAuB;AACpD,QAAI4H,MAAM,GAAG,IAAb;;AAEA,QAAIhG,OAAO,GAAG1C,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBmB,SAAzC,GAAqDnB,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAAlF;AAEA,QAAI2I,KAAK,GAAG,KAAK,CAAjB;AACA,QAAIjE,OAAO,GAAG,KAAK,CAAnB;AACA,QAAIiD,OAAO,GAAG,KAAK,CAAnB;AACA,QAAIC,MAAM,GAAG,KAAK,CAAlB;AAEA,QAAI,OAAO9G,IAAP,KAAgB,QAApB,EAA8BA,IAAI,GAAG,CAACA,IAAD,CAAP,CAVsB,CAYpD;;AACAA,IAAAA,IAAI,CAACqG,OAAL,CAAa,UAAUP,CAAV,EAAa;AACxB,UAAI8B,MAAM,CAAChD,aAAP,CAAqBiD,KAArB,CAAJ,EAAiC;;AACjC,UAAIC,SAAS,GAAGF,MAAM,CAACnF,cAAP,CAAsBqD,CAAtB,EAAyBlE,OAAzB,CAAhB;;AACA,UAAIvC,GAAG,GAAGyI,SAAS,CAACzI,GAApB;AACAuE,MAAAA,OAAO,GAAGvE,GAAV;AACA,UAAIsD,UAAU,GAAGmF,SAAS,CAACnF,UAA3B;AACA,UAAIiF,MAAM,CAAChG,OAAP,CAAemG,UAAnB,EAA+BpF,UAAU,GAAGA,UAAU,CAACqF,MAAX,CAAkBJ,MAAM,CAAChG,OAAP,CAAemG,UAAjC,CAAb;AAE/B,UAAI5B,mBAAmB,GAAGvE,OAAO,CAACkD,KAAR,KAAkBzE,SAAlB,IAA+B,OAAOuB,OAAO,CAACkD,KAAf,KAAyB,QAAlF;AACA,UAAImD,oBAAoB,GAAGrG,OAAO,CAACsG,OAAR,KAAoB7H,SAApB,IAAiC,OAAOuB,OAAO,CAACsG,OAAf,KAA2B,QAA5D,IAAwEtG,OAAO,CAACsG,OAAR,KAAoB,EAAvH;AAEA,UAAIC,KAAK,GAAGvG,OAAO,CAACwD,IAAR,GAAexD,OAAO,CAACwD,IAAvB,GAA8BwC,MAAM,CAACtC,aAAP,CAAqBK,kBAArB,CAAwC/D,OAAO,CAACM,GAAR,IAAe0F,MAAM,CAACzF,QAA9D,EAAwEP,OAAO,CAAC4D,WAAhF,CAA1C;AAEA7C,MAAAA,UAAU,CAAC0D,OAAX,CAAmB,UAAUzD,EAAV,EAAc;AAC/B,YAAIgF,MAAM,CAAChD,aAAP,CAAqBiD,KAArB,CAAJ,EAAiC;AACjCf,QAAAA,MAAM,GAAGlE,EAAT;AAEAuF,QAAAA,KAAK,CAAC9B,OAAN,CAAc,UAAU+B,IAAV,EAAgB;AAC5B,cAAIR,MAAM,CAAChD,aAAP,CAAqBiD,KAArB,CAAJ,EAAiC;AACjChB,UAAAA,OAAO,GAAGuB,IAAV;AAEA,cAAIC,QAAQ,GAAGhJ,GAAf;AACA,cAAIiJ,SAAS,GAAG,CAACD,QAAD,CAAhB;;AAEA,cAAIT,MAAM,CAACzD,UAAP,IAAqByD,MAAM,CAACzD,UAAP,CAAkBoE,aAA3C,EAA0D;AACxDX,YAAAA,MAAM,CAACzD,UAAP,CAAkBoE,aAAlB,CAAgCD,SAAhC,EAA2CjJ,GAA3C,EAAgD+I,IAAhD,EAAsDxF,EAAtD,EAA0DhB,OAA1D;AACD,WAFD,MAEO;AACL,gBAAI4G,YAAY,GAAG,KAAK,CAAxB;AACA,gBAAIrC,mBAAJ,EAAyBqC,YAAY,GAAGZ,MAAM,CAAC5C,cAAP,CAAsBC,SAAtB,CAAgCmD,IAAhC,EAAsCxG,OAAO,CAACkD,KAA9C,CAAf,CAFpB,CAIL;;AACA,gBAAIqB,mBAAmB,IAAI8B,oBAA3B,EAAiDK,SAAS,CAAC5C,IAAV,CAAe2C,QAAQ,GAAGG,YAA1B,EAL5C,CAOL;;AACA,gBAAIP,oBAAJ,EAA0BK,SAAS,CAAC5C,IAAV,CAAe2C,QAAQ,IAAI,KAAKT,MAAM,CAAChG,OAAP,CAAe6G,gBAApB,GAAuC7G,OAAO,CAACsG,OAA1E,EARrB,CAUL;;AACA,gBAAI/B,mBAAJ,EAAyBmC,SAAS,CAAC5C,IAAV,CAAe2C,QAAQ,IAAIG,YAA3B;AAC1B,WArB2B,CAuB5B;;;AACA,cAAIE,WAAW,GAAG,KAAK,CAAvB;AACA;;AACA,iBAAOA,WAAW,GAAGJ,SAAS,CAACK,GAAV,EAArB,EAAsC;AACpC,gBAAI,CAACf,MAAM,CAAChD,aAAP,CAAqBiD,KAArB,CAAL,EAAkC;AAChCA,cAAAA,KAAK,GAAGD,MAAM,CAACgB,WAAP,CAAmBR,IAAnB,EAAyBxF,EAAzB,EAA6B8F,WAA7B,EAA0C9G,OAA1C,CAAR;AACD;AACF;AACF,SA/BD;AAgCD,OApCD;AAqCD,KAlDD;AAoDA,WAAO;AAAEY,MAAAA,GAAG,EAAEqF,KAAP;AAAcjE,MAAAA,OAAO,EAAEA,OAAvB;AAAgCiD,MAAAA,OAAO,EAAEA,OAAzC;AAAkDC,MAAAA,MAAM,EAAEA;AAA1D,KAAP;AACD,GAlED;;AAoEArF,EAAAA,UAAU,CAACnC,SAAX,CAAqBsF,aAArB,GAAqC,SAASA,aAAT,CAAuBpC,GAAvB,EAA4B;AAC/D,WAAOA,GAAG,KAAKnC,SAAR,IAAqB,EAAE,CAAC,KAAKuB,OAAL,CAAaiH,UAAd,IAA4BrG,GAAG,KAAK,IAAtC,CAArB,IAAoE,EAAE,CAAC,KAAKZ,OAAL,CAAakH,iBAAd,IAAmCtG,GAAG,KAAK,EAA7C,CAA3E;AACD,GAFD;;AAIAf,EAAAA,UAAU,CAACnC,SAAX,CAAqBsJ,WAArB,GAAmC,SAASA,WAAT,CAAqBR,IAArB,EAA2BxF,EAA3B,EAA+BvD,GAA/B,EAAoC;AACrE,QAAIuC,OAAO,GAAG1C,SAAS,CAACC,MAAV,GAAmB,CAAnB,IAAwBD,SAAS,CAAC,CAAD,CAAT,KAAiBmB,SAAzC,GAAqDnB,SAAS,CAAC,CAAD,CAA9D,GAAoE,EAAlF;AAEA,QAAI,KAAKiF,UAAL,IAAmB,KAAKA,UAAL,CAAgByE,WAAvC,EAAoD,OAAO,KAAKzE,UAAL,CAAgByE,WAAhB,CAA4BR,IAA5B,EAAkCxF,EAAlC,EAAsCvD,GAAtC,EAA2CuC,OAA3C,CAAP;AACpD,WAAO,KAAKmH,aAAL,CAAmBH,WAAnB,CAA+BR,IAA/B,EAAqCxF,EAArC,EAAyCvD,GAAzC,EAA8CuC,OAA9C,CAAP;AACD,GALD;;AAOA,SAAOH,UAAP;AACD,CA3TgB,CA2TfH,YA3Te,CAAjB;;AA6TA,eAAeG,UAAf","sourcesContent":["var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _defaults(obj, defaults) { var keys = Object.getOwnPropertyNames(defaults); for (var i = 0; i < keys.length; i++) { var key = keys[i]; var value = Object.getOwnPropertyDescriptor(defaults, key); if (value && value.configurable && obj[key] === undefined) { Object.defineProperty(obj, key, value); } } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass); }\n\nimport baseLogger from './logger.js';\nimport EventEmitter from './EventEmitter.js';\nimport postProcessor from './postProcessor.js';\nimport * as utils from './utils.js';\n\nvar Translator = function (_EventEmitter) {\n  _inherits(Translator, _EventEmitter);\n\n  function Translator(services) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Translator);\n\n    var _this = _possibleConstructorReturn(this, _EventEmitter.call(this));\n\n    utils.copy(['resourceStore', 'languageUtils', 'pluralResolver', 'interpolator', 'backendConnector', 'i18nFormat'], services, _this);\n\n    _this.options = options;\n    if (_this.options.keySeparator === undefined) {\n      _this.options.keySeparator = '.';\n    }\n\n    _this.logger = baseLogger.create('translator');\n    return _this;\n  }\n\n  Translator.prototype.changeLanguage = function changeLanguage(lng) {\n    if (lng) this.language = lng;\n  };\n\n  Translator.prototype.exists = function exists(key) {\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : { interpolation: {} };\n\n    var resolved = this.resolve(key, options);\n    return resolved && resolved.res !== undefined;\n  };\n\n  Translator.prototype.extractFromKey = function extractFromKey(key, options) {\n    var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n    if (nsSeparator === undefined) nsSeparator = ':';\n\n    var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n\n    var namespaces = options.ns || this.options.defaultNS;\n    if (nsSeparator && key.indexOf(nsSeparator) > -1) {\n      var parts = key.split(nsSeparator);\n      if (nsSeparator !== keySeparator || nsSeparator === keySeparator && this.options.ns.indexOf(parts[0]) > -1) namespaces = parts.shift();\n      key = parts.join(keySeparator);\n    }\n    if (typeof namespaces === 'string') namespaces = [namespaces];\n\n    return {\n      key: key,\n      namespaces: namespaces\n    };\n  };\n\n  Translator.prototype.translate = function translate(keys, options) {\n    var _this2 = this;\n\n    if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object' && this.options.overloadTranslationOptionHandler) {\n      /* eslint prefer-rest-params: 0 */\n      options = this.options.overloadTranslationOptionHandler(arguments);\n    }\n    if (!options) options = {};\n\n    // non valid keys handling\n    if (keys === undefined || keys === null || keys === '') return '';\n    if (typeof keys === 'number') keys = String(keys);\n    if (typeof keys === 'string') keys = [keys];\n\n    // separators\n    var keySeparator = options.keySeparator !== undefined ? options.keySeparator : this.options.keySeparator;\n\n    // get namespace(s)\n\n    var _extractFromKey = this.extractFromKey(keys[keys.length - 1], options),\n        key = _extractFromKey.key,\n        namespaces = _extractFromKey.namespaces;\n\n    var namespace = namespaces[namespaces.length - 1];\n\n    // return key on CIMode\n    var lng = options.lng || this.language;\n    var appendNamespaceToCIMode = options.appendNamespaceToCIMode || this.options.appendNamespaceToCIMode;\n    if (lng && lng.toLowerCase() === 'cimode') {\n      if (appendNamespaceToCIMode) {\n        var nsSeparator = options.nsSeparator || this.options.nsSeparator;\n        return namespace + nsSeparator + key;\n      }\n\n      return key;\n    }\n\n    // resolve from store\n    var resolved = this.resolve(keys, options);\n    var res = resolved && resolved.res;\n    var resUsedKey = resolved && resolved.usedKey || key;\n\n    var resType = Object.prototype.toString.apply(res);\n    var noObject = ['[object Number]', '[object Function]', '[object RegExp]'];\n    var joinArrays = options.joinArrays !== undefined ? options.joinArrays : this.options.joinArrays;\n\n    // object\n    var handleAsObjectInI18nFormat = !this.i18nFormat || this.i18nFormat.handleAsObject;\n    var handleAsObject = typeof res !== 'string' && typeof res !== 'boolean' && typeof res !== 'number';\n    if (handleAsObjectInI18nFormat && res && handleAsObject && noObject.indexOf(resType) < 0 && !(joinArrays && resType === '[object Array]')) {\n      if (!options.returnObjects && !this.options.returnObjects) {\n        this.logger.warn('accessing an object - but returnObjects options is not enabled!');\n        return this.options.returnedObjectHandler ? this.options.returnedObjectHandler(resUsedKey, res, options) : 'key \\'' + key + ' (' + this.language + ')\\' returned an object instead of string.';\n      }\n\n      // if we got a separator we loop over children - else we just return object as is\n      // as having it set to false means no hierarchy so no lookup for nested values\n      if (keySeparator) {\n        var copy = resType === '[object Array]' ? [] : {}; // apply child translation on a copy\n\n        /* eslint no-restricted-syntax: 0 */\n        for (var m in res) {\n          if (Object.prototype.hasOwnProperty.call(res, m)) {\n            var deepKey = '' + resUsedKey + keySeparator + m;\n            copy[m] = this.translate(deepKey, _extends({}, options, { joinArrays: false, ns: namespaces }));\n            if (copy[m] === deepKey) copy[m] = res[m]; // if nothing found use orginal value as fallback\n          }\n        }\n        res = copy;\n      }\n    } else if (handleAsObjectInI18nFormat && joinArrays && resType === '[object Array]') {\n      // array special treatment\n      res = res.join(joinArrays);\n      if (res) res = this.extendTranslation(res, keys, options);\n    } else {\n      // string, empty or null\n      var usedDefault = false;\n      var usedKey = false;\n\n      // fallback value\n      if (!this.isValidLookup(res) && options.defaultValue !== undefined) {\n        usedDefault = true;\n\n        if (options.count !== undefined) {\n          var suffix = this.pluralResolver.getSuffix(lng, options.count);\n          res = options['defaultValue' + suffix];\n        }\n        if (!res) res = options.defaultValue;\n      }\n      if (!this.isValidLookup(res)) {\n        usedKey = true;\n        res = key;\n      }\n\n      // save missing\n      var updateMissing = options.defaultValue && options.defaultValue !== res && this.options.updateMissing;\n      if (usedKey || usedDefault || updateMissing) {\n        this.logger.log(updateMissing ? 'updateKey' : 'missingKey', lng, namespace, key, updateMissing ? options.defaultValue : res);\n\n        var lngs = [];\n        var fallbackLngs = this.languageUtils.getFallbackCodes(this.options.fallbackLng, options.lng || this.language);\n        if (this.options.saveMissingTo === 'fallback' && fallbackLngs && fallbackLngs[0]) {\n          for (var i = 0; i < fallbackLngs.length; i++) {\n            lngs.push(fallbackLngs[i]);\n          }\n        } else if (this.options.saveMissingTo === 'all') {\n          lngs = this.languageUtils.toResolveHierarchy(options.lng || this.language);\n        } else {\n          lngs.push(options.lng || this.language);\n        }\n\n        var send = function send(l, k) {\n          if (_this2.options.missingKeyHandler) {\n            _this2.options.missingKeyHandler(l, namespace, k, updateMissing ? options.defaultValue : res, updateMissing, options);\n          } else if (_this2.backendConnector && _this2.backendConnector.saveMissing) {\n            _this2.backendConnector.saveMissing(l, namespace, k, updateMissing ? options.defaultValue : res, updateMissing, options);\n          }\n          _this2.emit('missingKey', l, namespace, k, res);\n        };\n\n        if (this.options.saveMissing) {\n          var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n          if (this.options.saveMissingPlurals && needsPluralHandling) {\n            lngs.forEach(function (l) {\n              var plurals = _this2.pluralResolver.getPluralFormsOfKey(l, key);\n\n              plurals.forEach(function (p) {\n                return send([l], p);\n              });\n            });\n          } else {\n            send(lngs, key);\n          }\n        }\n      }\n\n      // extend\n      res = this.extendTranslation(res, keys, options, resolved);\n\n      // append namespace if still key\n      if (usedKey && res === key && this.options.appendNamespaceToMissingKey) res = namespace + ':' + key;\n\n      // parseMissingKeyHandler\n      if (usedKey && this.options.parseMissingKeyHandler) res = this.options.parseMissingKeyHandler(res);\n    }\n\n    // return\n    return res;\n  };\n\n  Translator.prototype.extendTranslation = function extendTranslation(res, key, options, resolved) {\n    var _this3 = this;\n\n    if (this.i18nFormat && this.i18nFormat.parse) {\n      res = this.i18nFormat.parse(res, options, resolved.usedLng, resolved.usedNS, resolved.usedKey, { resolved: resolved });\n    } else if (!options.skipInterpolation) {\n      // i18next.parsing\n      if (options.interpolation) this.interpolator.init(_extends({}, options, { interpolation: _extends({}, this.options.interpolation, options.interpolation) }));\n\n      // interpolate\n      var data = options.replace && typeof options.replace !== 'string' ? options.replace : options;\n      if (this.options.interpolation.defaultVariables) data = _extends({}, this.options.interpolation.defaultVariables, data);\n      res = this.interpolator.interpolate(res, data, options.lng || this.language, options);\n\n      // nesting\n      if (options.nest !== false) res = this.interpolator.nest(res, function () {\n        return _this3.translate.apply(_this3, arguments);\n      }, options);\n\n      if (options.interpolation) this.interpolator.reset();\n    }\n\n    // post process\n    var postProcess = options.postProcess || this.options.postProcess;\n    var postProcessorNames = typeof postProcess === 'string' ? [postProcess] : postProcess;\n\n    if (res !== undefined && res !== null && postProcessorNames && postProcessorNames.length && options.applyPostProcessor !== false) {\n      res = postProcessor.handle(postProcessorNames, res, key, options, this);\n    }\n\n    return res;\n  };\n\n  Translator.prototype.resolve = function resolve(keys) {\n    var _this4 = this;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    var found = void 0;\n    var usedKey = void 0;\n    var usedLng = void 0;\n    var usedNS = void 0;\n\n    if (typeof keys === 'string') keys = [keys];\n\n    // forEach possible key\n    keys.forEach(function (k) {\n      if (_this4.isValidLookup(found)) return;\n      var extracted = _this4.extractFromKey(k, options);\n      var key = extracted.key;\n      usedKey = key;\n      var namespaces = extracted.namespaces;\n      if (_this4.options.fallbackNS) namespaces = namespaces.concat(_this4.options.fallbackNS);\n\n      var needsPluralHandling = options.count !== undefined && typeof options.count !== 'string';\n      var needsContextHandling = options.context !== undefined && typeof options.context === 'string' && options.context !== '';\n\n      var codes = options.lngs ? options.lngs : _this4.languageUtils.toResolveHierarchy(options.lng || _this4.language, options.fallbackLng);\n\n      namespaces.forEach(function (ns) {\n        if (_this4.isValidLookup(found)) return;\n        usedNS = ns;\n\n        codes.forEach(function (code) {\n          if (_this4.isValidLookup(found)) return;\n          usedLng = code;\n\n          var finalKey = key;\n          var finalKeys = [finalKey];\n\n          if (_this4.i18nFormat && _this4.i18nFormat.addLookupKeys) {\n            _this4.i18nFormat.addLookupKeys(finalKeys, key, code, ns, options);\n          } else {\n            var pluralSuffix = void 0;\n            if (needsPluralHandling) pluralSuffix = _this4.pluralResolver.getSuffix(code, options.count);\n\n            // fallback for plural if context not found\n            if (needsPluralHandling && needsContextHandling) finalKeys.push(finalKey + pluralSuffix);\n\n            // get key for context if needed\n            if (needsContextHandling) finalKeys.push(finalKey += '' + _this4.options.contextSeparator + options.context);\n\n            // get key for plural if needed\n            if (needsPluralHandling) finalKeys.push(finalKey += pluralSuffix);\n          }\n\n          // iterate over finalKeys starting with most specific pluralkey (-> contextkey only) -> singularkey only\n          var possibleKey = void 0;\n          /* eslint no-cond-assign: 0 */\n          while (possibleKey = finalKeys.pop()) {\n            if (!_this4.isValidLookup(found)) {\n              found = _this4.getResource(code, ns, possibleKey, options);\n            }\n          }\n        });\n      });\n    });\n\n    return { res: found, usedKey: usedKey, usedLng: usedLng, usedNS: usedNS };\n  };\n\n  Translator.prototype.isValidLookup = function isValidLookup(res) {\n    return res !== undefined && !(!this.options.returnNull && res === null) && !(!this.options.returnEmptyString && res === '');\n  };\n\n  Translator.prototype.getResource = function getResource(code, ns, key) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n    if (this.i18nFormat && this.i18nFormat.getResource) return this.i18nFormat.getResource(code, ns, key, options);\n    return this.resourceStore.getResource(code, ns, key, options);\n  };\n\n  return Translator;\n}(EventEmitter);\n\nexport default Translator;"]},"metadata":{},"sourceType":"module"}